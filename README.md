# Stampery

[![NPM Package](https://img.shields.io/npm/v/stampery.svg?style=flat-square)](https://www.npmjs.org/package/stampery)

__NodeJS__ client library for [__Stampery API__](https://stampery.com/api), the __blockchain-powered__, __industrial-scale certification platform__.

Seamlessly integrate industrial-scale data certification and timestamping into your own NodeJS apps. The Stampery API adds a layer of __transparency__, __attribution__, __accountability__ and __auditability__ to your applications by connecting them to Stampery's infinitely scalable [__Blockchain Timestamping Architecture__](https://stampery.com/tech).

## Background

The Stampery API embeds unique identifiers (hashes) of your files and datasets into the __Ethereum__ and __Bitcoin__ blockchains. It allows you to __prove the existence__, __integrity__ and __ownership__ of all your data.

The timestamps and proofs generated by this API are __independently verifiable__ at no cost by anyone in the world, and they will be __valid forever__â€”even if Stampery disappeared.

Each proof connects every single stamped hash to a transaction contained in the next Ethereum and Bitcoin block. This means that __Ethereum receipts take ~30 seconds__ in average to be generated, while __Bitcoin ones take ~5 minutes__.

Our __BTA__ technology aggregates all hashes received between one transaction and the next one by putting them inside a [Merkle tree](https://en.wikipedia.org/wiki/Merkle_tree) and then broadcasting the result of the aggregationâ€”which we call the __Merkle root__. This allows us to include  __millions of hashes__ in every transaction at a fraction of the cost and without loosing the immutabiity properties of public blockchains.

The proofs themselves contain only a few auxiliar hashes that when concurrently hashed together with your stamped hash, allow to reconstruct the state of the Merkle tree at the very exact point in time when the stamping took place.

As the all the hash functions involved in the aggregation are [one-way functions](https://en.wikipedia.org/wiki/One-way_function), __there is no way to counterfeit a proof__ that would connect a certain hash to any past transaction. Likewise, it is impossible to make up a fake proof that would be valid for a tampered file.

__You can read more about BTA in__ [__our whitepaper__](https://s3.amazonaws.com/stampery-cdn/docs/Stampery-BTA-v5-whitepaper.pdf).

#### Glossary

* The process of embeding one hash into a blockchain is called __stamping__.
* One embeded hash is called a __stamp__.
* The stamping process will return one __receipt__ for every blockchain being used.
* Each __receipt__ contains all the necessary data for proving the existence and integrity of the stamped data.
* __Proving__ means demonstrating that a __receipt__ is valid and therefore the file or dataset from which the hash was calculated existed by the time the stamp was made.


## Installation

  1. Install `stampery` into your project and add it as a dependency in your `package.json`:

```
npm install --save stampery
```

  2. Go to the [API dashboard](https://api-dashboard.stampery.com), sign up, create a token for your application (or use the default one) and copy its user secret. It will resemble this:

```
14f1e553-325f-4549-ced6-6c5311b1a470
```

## Usage
### Basic setup
```javascript
/**
* Import Stampery API for NodeJS
 */
const Stampery = require('stampery');

/**
* Please replace this dummy user secret with a real one.
* Sign up and get your own user secret at https://api-dashboard.stampery.com
 */
var stampery = new Stampery('14f1e553-325f-4549-ced6-6c5311b1a470');
```

### Stamping workflow
```javascript
/**
* Simple workflow for stamping a string.
* This will return all the data related to the stamp plus an estimation of the
* remaining time in seconds for the Ethereum and Bitcoin receipts to be ready
* for proving. Average ETA is ~30 seconds for ETH and ~5 minutes for BTC.
 */
var h = stampery.hash('the piano has been drinking ' + Math.random());
stampery.stamp(h, function(err, stamp) {
  if (err) {
    return console.error(err);
  }
  return console.log(stamp);
});
```

### Retrieving and proving a stamp and its receipts
```javascript
/**
* Example for retrieving the receipts for a certain stamp at any time
* afterwards. It also verifies if the proof is valid and prints the result.
 */
stampery.getById('5857d1629e7cba66c3ea20a8', function(err, res) {
  if (err) {
    return console.error(err);
  }
  console.log(res);
  if (res) {
    return console.log('Valid: ', stampery.prove(res.receipts));
  }
});
```

### Retrieving all stamps related to a hash
```javascript
/**
* Example for retrieving all the stamps and receipts related to a certain file
* hash at any time afterwards.
 */
stampery.getByHash('<put here the file hash>', function(err, res) {
  if (err) {
    return console.error(err);
  }
  return console.log(res);
});
```

### Retrieving the whole stamp history
```javascript
/**
* Example for retrieving all the receipts in your stamps history at any time
* afterwards. For the sake of responsiveness, it will return only the last 50
* stamps (page 0).
 */
stampery.getAll(function(err, res) {
  if (err) {
    return console.error(err);
  }
  return console.log(res);
});
```
```javascript
/**
* Example for retrieving next 50 receipts from the stamps history.
* Increase the first argument to get page 0, 1, 2, 3 and so on.
* This example should return stamps numbers from 200 to 249.
 */
stampery.getAll(4, function(err, res) {
  if (err) {
    return console.error(err);
  }
  return console.log(res);
});
```

## Other languages and platforms

Stampery API is also available in many other languages and platforms:
- [Python](https://github.com/stampery/python)
- [Ruby](https://github.com/stampery/ruby)
- [Go](https://github.com/stampery/go)
- [Elixir](https://github.com/stampery/elixir)
- [Java](https://github.com/stampery/java)
- [PHP](https://github.com/stampery/php)

## Feedback

Ping us at [support@stampery.com](mailto:support@stampery.com) and we will be more than happy to help you with your integration! ðŸ˜ƒ

## License

Code released under [the MIT license](https://github.com/stampery/node/blob/master/LICENSE).

Â© 2015-2016 Stampery, Inc.
